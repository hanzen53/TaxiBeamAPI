# Passenger API
Intended for Passenger's app to call

## Table of Contents
- [Constants](#Constants)
- [Communication and Encryption Protocols](#Communication_and_Encryption_Protocols)
- [HTTP Status](#HTTP_Status)
- [Composite Data Classes](#Composite_Data_Classes)
    - [Profile](#Profile)
    - [Direction](#Direction)
    - [Position](#Position)
    - [Car](#Car)
    - [Place](#Place)
- [Enumerables](#Enumerables)
- [API Calls](#API_Calls)
    - [Register](#Register)
    - [Login using a password](#Login_using_a_password)
    - [Login using Facebook](#Login_using_Facebook)
    - [Logout](#Logout)
    - [Retriving status](#Retriving_status)
    - [Updating status](#Updating_status)
    - [Updating profile](#Updating_profile)
    - [Changing password](#Changing_password)
    - [Resetting password](#Resetting_password)
    - [Getting news](#Getting_news)
    - [Searching for taxis](#Searching_for_taxis)
    - [Calling a taxi](#Calling_a_taxi)
    - [Refreshing status](#Refreshing_status)
    - [Cancelling a call](#Cancelling_a_call)
    - [Declining a challenge](#Declining_a_challenge)
    - [Accepting a challenge](#Accepting_a_challenge)
    - [Starting a trip](#Starting_a_trip)
    - [Ending a trip](#Ending_a_trip)
    - [Retriving favorite taxis](#Retriving_favorite_taxis)
    - [Setting a favorite taxi](#Setting_a_favorite_taxi)
    - [Retriving favorite places](#Retriving_favorite_places)
    - [Setting a favorite place](#Setting_a_favorite_place)

<a name="Constants"></a>
## Constants
Name              | Value | Description
------------------|-------|-------------
*SECRET_KEY*      |`String` Taxi:b42f1a04-8449-4b5a-afb9-2229dd3c1e4a:Beam|A string used as a key to encrypt/decrypt data in two-way encryption algorithm. It is also used to append raw data (as a salt) in hashing operations.
*SEARCH_RADIUS*   |`Integer` 5,000 meters|The default radius from a location to look for surrounding cars.
*MAX_SEARCHRESULT*|`Integer` 200 cars|The maximum number of cars to return from APIs.

<a name="Communication_and_Encryption_Protocols"></a>
## Communication and Encryption Protocols
- All two-way encryptions are using *AES-256* algorithm with *SECRET_KEY* as a key.
    - Try [Online AES Encryption](http://aesencryption.net)
    - An encrypted string of `P@ssw0rd` should be `v8QOINsVbW1YIuKLFil4Sleoz+NpXFeZyT+AnFrpujw=`
- All hash operations are implemented with *SHA-256*. The hash operation should append the input data with *SECRET_KEY*.
    - Try [SHA256 Calculator](http://www.xorbin.com/tools/sha256-hash-calculator)
    - For example, for an input string of `P@ssw0rd`, the hash should be calculated from:

~~~~js
SHA256("P@ssw0rdTaxi:b42f1a04-8449-4b5a-afb9-2229dd3c1e4a:Beam")
// The result should be 117b5ca7dd4d1813774bc736d5a1388d01f94c6f667bd4e24b71472088d466b8
~~~~

- All sensitive data, including but not limited to, passwords and credit-card numbers must be securely encrypted before transmitting over network.
- **auth_token** is generated by randomizing a new GUID, associating it with a user's session, and storing session information in the database or the caching server. The server must not return the GUID in plaintext, instead, encrypting it with the agreed two-way encryption mechanism.
- For all eligible API calls the server must decrypt the **auth_token**, if provided, and check its vadility against the database.
- The **msg** variable in API responses should contain error messages and instructions that are appropriate to be shown to external users.

<a name="HTTP_Status"></a>
## HTTP Status
When a problematic request is received, the server should return the following HTTP statuses:

- 200 OK
    - The request is valid and the server successfully processes the request.
- 400 Bad Request
    - The request syntax is malformed, therefore, the server could not understand the request message.
- 403 Forbidden
    - The request is not authenticated. The user may not have an appropriate permission, or the login token has expired.
- 404 Not Found
    - The requested operation is not available, or the requested operation may not exist.
- 500 Internal Server Error
     - A unhandled exception occurs while processing the request. More information can be found in server logs.

<a name="Composite_Data_Classes"></a>
## Composite Data Classes
<a name="Profile"></a>
### Profile
- The class contains user-related personal information. **Profile** should be retrieved/renewed upon user login.

Example:

~~~~js
{
  "passenger_id": "558239609a2c8bd8080ae497",
  "email": "narun@ecartstudio.com",
  "mobile_phone": "0813234415",
  "favorite_car_type": "car",
  "favorite_car_id": ["6566541161f521f7f6f99bfc5a", "8d0477659af995c221aa2f8f98", ...]
}
~~~~

---
<a name="Direction"></a>
### Direction
- **Direction** provides more detail about the current geographical status of a target, in addition to **Position**. It should be an array with two elements, accuracy and degree. An accuracy is an integer measured in meter. A degree is the direction of heading measured from the North (ranges from 0 to 359).

Example:

~~~~js
{
  "direction": [15, 270]
  // GPS accuracy is at 15 meters, heading west
}
~~~~

---

<a name="Position"></a>
### Position
- A **Position** is represented by an array of numbers. There must be two elements, which follow the x, y order (longitude, latitude for coordinates).

Example:

~~~~js
{
  "position": [100.57171, 13.75602]
}
~~~~

---
<a name="Car"></a>
### Car
- A **Car** is a dictionary used to provide detail about taxis. Members will be explained through the example.

Example:

~~~~js
{
  "car_id": "557aa2b078aed5080f702c19",
  "driver_firstname": "สมใจ",
  "driver_lastname": "สมสกุล",
  "driver_mobile_phone": "0874345545",   // Format 0\d{9}
  "car_status": "ON",   // See status dictionary below
  "car_license_plate": "1กค 7672",   // Format .?.. \d{1,4}
  "car_type": "car",   // Can be "car", "minivan"
  "car_color": 1,   // See color dictionary below
  "willing_outbound": false,   // Whether the driver is willing to go out of the city
  "willing_carryluggage": false,   // Whether the driver is willing to carry heavy luggages
  "image_driver": "http://www.taxi-beam.com/upload/drivers/557aa2b078aed5080f702c19.jpg",
  "image_car": "http://www.taxi-beam.com/upload/cars/557aa2b078aed5080f702c19.jpg",
  "image_license_plate": "http://www.taxi-beam.com/plates/557aa2b078aed5080f702c19.jpg",
  "current_position": **POSITION_CLASS**,
  "current_direction": **DIRECTION_CLASS**,
  "garage_id": "9c07a32cc6f6ede71a018"
}
~~~~

---
<a name="Place"></a>
### Place
- **Place** includes a name and its **Position**.
- Note that the value of the parameter *place_id* should be null when saving a new place. The value is to be generated on the server-side only.

Example:

~~~~js
{
  "place_id": "13ba9a16e6f2495fa6fc1c044b4e8acd",
  "name": "บริษัท อีคาร์ทสตูดิโอ จำกัด",
  "position": **POSITION_CLASS**
}
~~~~

<a name="Enumerables"></a>
## Enumerables
- Possible passenger status:

Status  | Description
------- | ------------
OFF     | The passenger does not need a service.
CALL    | The passenger is calling a taxi.
WAIT    | The passenger is selected by a driver, waiting for the passenger to confirm.
CONFIRM | The passenger confirms the pickup. The taxi is now en route.
JOURNEY | The passenger is picked up and currently in a journey.

- Possible car status:

Status    | Description
--------- | ------------
OFF       | The driver is offline.
AVAILABLE | The driver is available and ready.
CHALLENGE | The driver selected a passenger.
ENROUTE   | The driver is accepted by a passenger and en route.
JOURNEY   | The driver picked up a passenger and currently in a journey.
OUT       | The car is under maintenance and unable to provide services.

- Possible car color:

Color ID | Description
-------- | ------------
1        | Green-Yellow
2        | Yellow-Blue
3        | Blue-Red
4        | Pink-White
5        | White-Red
6        | Pink
7        | Bue
8        | Yellow
9        | Red
10       | Green
11       | Orange
12       | Purple


<a name="API_Calls"></a>
## API Calls
<a name="Register"></a>
### Register
- Registering a new account for passengers. Each account should have a unique email address. Once registered, the system automatically logs the user in.
- URL `/service/passenger/register`
- Method `POST`
- Input Parameters

> **email**:  `String` Passenger's email. (Unique, Mandotary)  
> **mobile_phone**:  `String` Passenger's mobile phone number. (Not requred)  
> **new_password**:  `String` The desired password encrypted with the agreed hashing mechanism. (at least 6 characters)

- Output Parameters

> **success**:  `Boolean` Returns *true* if the requested operation is valid, otherwise *false*.  
> **msg**:  `String` Additional information or error messages. Usually provided when the requested operation is invalid.  
> **data**:  {  
> &nbsp;&nbsp; **auth_token**: `String` An authentication token associated with the passenger's session.  
> &nbsp;&nbsp; **profile**:  `**PROFILE_CLASS**` A personal profile for the current passenger.  
> }

- Example Request

~~~~js
{
  "email": "narun@ecartstudio.com",
  "mobile_phone": "0813234415",
  "new_password": "00a4a9f42458c74885ae8138e1bb88bc5814c9158994c00d61e2a204aae698f0"   // Raw password is Kxu132Zxa  
}
~~~~

- Example Response

~~~~js
{
  "success": true,
  "msg": null,
  "data": {
    "auth_token": "PbXQ2YTcmyzAXxpA7CF0eOW5Cd6eu/0RS2GZiXEbyLpBZpJh1NY5ynIlb8Pvb/gAD5Ies/gPXeFbZQmCA4p2Pw==",   // Raw session GUID is a569edeb-1479-4f33-850e-1d723c268ec0
    "profile": {
      "passenger_id": "558239609a2c8bd8080ae497",
      "email": "narun@ecartstudio.com",
      "mobile_phone": "0813234415",
      "favorite_car_type": "car",
      "favorite_car_id": ["6566541161f521f7f6f99bfc5a", "8d0477659af995c221aa2f8f98", ...]
    }
  }
}
~~~~

---
<a name="Login_using_a_password"></a>
### Login using a password
- URL `/service/passenger/login`
- Method `POST`
- Input Parameters

> **email**:  `String` The user's email as an username.  
> **password**:  `String` Hashed login password.

- Output Parameters

> **success**:  `Boolean` Returns *true* if the requested operation is valid, otherwise *false*.  
> **msg**:  `String` Additional information or error messages. Usually provided when the requested operation is invalid.  
> **data**:  {  
> &nbsp;&nbsp; **auth_token**: `String` An authentication token associated with the passenger's session.  
> &nbsp;&nbsp; **profile**:  `**PROFILE_CLASS**` A personal profile for the current passenger.  
> }

- Example Request

~~~~js
{
  "email": "narun@ecartstudio.com",
  "password": "653fb717cefd68be7d6ecc96ad312dd5467ed2f3f38f754f13b14f907d086f33"   // Raw password is vahQX91c  
}
~~~~

 - Example Response

~~~~js
{
  "success": true,
  "msg": null,
  "data": {
    "auth_token": "PbXQ2YTcmyzAXxpA7CF0eOW5Cd6eu/0RS2GZiXEbyLpBZpJh1NY5ynIlb8Pvb/gAD5Ies/gPXeFbZQmCA4p2Pw==",   // Raw session GUID is a569edeb-1479-4f33-850e-1d723c268ec0
    "profile": {
      "passenger_id": "558239609a2c8bd8080ae497",
      "email": "narun@ecartstudio.com",
      "mobile_phone": "0813234415",
      "favorite_car_type": "car",
      "favorite_car_id": ["6566541161f521f7f6f99bfc5a", "8d0477659af995c221aa2f8f98", ...]
    }
  }
}
~~~~

---
<a name="Login_using_Facebook"></a>
### Login using Facebook
- URL `/service/passenger/facebooklogin`
- Method `POST`
- Input Parameters

> **fb\_access\_token**:  `String` The access token issued by Facebook authentication services.

- Output Parameters

> **success**:  `Boolean` Returns *true* if the requested operation is valid, otherwise *false*.  
> **msg**:  `String` Additional information or error messages. Usually provided when the requested operation is invalid.  
> **data**:  {  
> &nbsp;&nbsp; **auth_token**: `String` An authentication token associated with the passenger's session.  
> &nbsp;&nbsp; **profile**:  `**PROFILE_CLASS**` A personal profile for the current passenger.  
> }

- Example Request

~~~~js
{
  "fb_access_token": "CAACEdEose0cBAPjmCH4ZASt6FMktfYhatqVcgWBJtD2arL5hTTEsRwnC8p9rDOQqXxoWDcOgiV1vKZAkvwhNApy8ThXpcFaoLLZC7qvUdu3z41O9l2lO2fgiIoSzVGQZCNIp1cAJJVYPluFkQZAw2aGk0OOZB5Er2eLj3YkLluUZB1dsnWogdEMGEBtBeMigz1ZCcSyZA96ZB0WYeBZAoi9fN56"
}
~~~~

 - Example Response

~~~~js
{
  "success": true,
  "msg": null,
  "data": {
    "auth_token": "PbXQ2YTcmyzAXxpA7CF0eOW5Cd6eu/0RS2GZiXEbyLpBZpJh1NY5ynIlb8Pvb/gAD5Ies/gPXeFbZQmCA4p2Pw==",   // Raw session GUID is a569edeb-1479-4f33-850e-1d723c268ec0  
    "profile": {
      "passenger_id": "558239609a2c8bd8080ae497",
      "email": "narun@ecartstudio.com",
      "mobile_phone": "0813234415",
      "favorite_car_type": "car",
      "favorite_car_id": ["6566541161f521f7f6f99bfc5a", "8d0477659af995c221aa2f8f98", ...]
    }
  }
}
~~~~

---
<a name="Logout"></a>
### Logout
- URL `/service/passenger/logout`
- Method `POST`
- Input Parameters

> **auth_token**: `String` An authentication token obtained from the login.  

- Output Parameters

> **success**:  `Boolean` Returns *true* if the requested operation is valid, otherwise *false*.  
> **msg**:  `String` Additional information or error messages. Usually provided when the requested operation is invalid.  

- Example Request

~~~~js
{
  "auth_token": "PbXQ2YTcmyzAXxpA7CF0eOW5Cd6eu/0RS2GZiXEbyLpBZpJh1NY5ynIlb8Pvb/gAD5Ies/gPXeFbZQmCA4p2Pw=="
}
~~~~

 - Example Response

~~~~js
{
  "success": true,
  "msg": null
}
~~~~

---
<a name="Retriving_status"></a>
### Retriving status
- URL `/service/passenger/status`
- Method `POST`
- Input Parameters

> **auth_token**: `String` An authentication token obtained from the login.  

- Output Parameters

> **success**:  `Boolean` Returns *true* if the requested operation is valid, otherwise *false*.  
> **msg**:  `String` Additional information or error messages. Usually provided when the requested operation is invalid.  
> **data**: {  
> &nbsp;&nbsp;**passenger_status**: `String` The current status of the passenger.  
> }

- Example Request

~~~~js
{
  "auth_token": "PbXQ2YTcmyzAXxpA7CF0eOW5Cd6eu/0RS2GZiXEbyLpBZpJh1NY5ynIlb8Pvb/gAD5Ies/gPXeFbZQmCA4p2Pw=="
}
~~~~

 - Example Response

~~~~js
{
  "success": true,
  "msg": null,
  "data": {
    "passenger_status": "WAIT"
  }
}
~~~~

---
<a name="Updating_status"></a>
### Updating status
- URL `/service/passenger/status/update`
- Method `POST`
- Input Parameters

> **auth_token**: `String` An authentication token obtained from the login.  
> **passenger_status**: `String` The new status of the current user.

- Output Parameters

> **success**:  `Boolean` Returns *true* if the requested operation is valid, otherwise *false*.  
> **msg**:  `String` Additional information or error messages. Usually provided when the requested operation is invalid.  

- Example Request

~~~~js
{
  "auth_token": "PbXQ2YTcmyzAXxpA7CF0eOW5Cd6eu/0RS2GZiXEbyLpBZpJh1NY5ynIlb8Pvb/gAD5Ies/gPXeFbZQmCA4p2Pw==",
  "passenger_status": "OFF"
}
~~~~

 - Example Response

~~~~js
{
  "success": true,
  "msg": null
}
~~~~

---
<a name="Updating_profile"></a>
### Updating profile
- URL `/service/passenger/profile/update`
- Method `POST`
- Input Parameters

> **auth_token**: `String` An authentication token obtained from the login.  
> **new_email**: `String` New email. (Leave blank if unchanged)  
> **new\_mobile\_phone**: `String` New phone number. (Leave blank if unchanged)  
> **new_language**: `String` Preferred UI language. (Leave blank if unchanged)  

- Output Parameters

> **success**:  `Boolean` Returns *true* if the requested operation is valid, otherwise *false*.  
> **msg**:  `String` Additional information or error messages. Usually provided when the requested operation is invalid.  

- Example Request

~~~~js
{
  "auth_token": "PbXQ2YTcmyzAXxpA7CF0eOW5Cd6eu/0RS2GZiXEbyLpBZpJh1NY5ynIlb8Pvb/gAD5Ies/gPXeFbZQmCA4p2Pw==",
  "new_email": "narun@ecartstudio.com",
  "new_mobile_phone": "",
  "new_language": "en"
}
~~~~

 - Example Response

~~~~js
{
  "success": true,
  "msg": null
}
~~~~

---
<a name="Changing_password"></a>
### Changing password
- URL `/service/passenger/profile/changepassword`
- Method `POST`
- Input Parameters

> **auth_token**: `String` An authentication token obtained from the login.  
> **new_password**: `String` Hashed new password. (Leave blank if unchanged)  
> **password**: `String` Hashed current password. (Only required if users are changing their passwords)  

- Output Parameters

> **success**:  `Boolean` Returns *true* if the requested operation is valid, otherwise *false*.  
> **msg**:  `String` Additional information or error messages. Usually provided when the requested operation is invalid.  

- Example Request

~~~~js
{
  "auth_token": "PbXQ2YTcmyzAXxpA7CF0eOW5Cd6eu/0RS2GZiXEbyLpBZpJh1NY5ynIlb8Pvb/gAD5Ies/gPXeFbZQmCA4p2Pw==",
  "new_password": "193524854ea0bc2f45c8f08ad80a93d56c867e96f02f37dbdab44ed5ad8ff231",   // Raw new password is Nv817Ux01
  "password": "653fb717cefd68be7d6ecc96ad312dd5467ed2f3f38f754f13b14f907d086f33"
}
~~~~

 - Example Response

~~~~js
{
  "success": true,
  "msg": null
}
~~~~

---
<a name="Resetting_password"></a>
### Resetting password
- URL `/service/passenger/profile/resetpassword`
- Method `POST`
- Input Parameters

> **email**:  `String` Passenger's email. (Unique, Mandotary)  

- Output Parameters

> **success**:  `Boolean` Returns *true* if the requested operation is valid, otherwise *false*.  
> **msg**:  `String` Additional information or error messages. Usually provided when the requested operation is invalid.  

- Example Request

~~~~js
{
  "email": "narun@ecartstudio.com"
}
~~~~

 - Example Response

~~~~js
{
  "success": true,
  "msg": null
}
~~~~

---
<a name="Getting_news"></a>
### Getting news
- URL `/service/broadcast/passenger`
- Method `POST`
- Input Parameters

> **auth_token**: `String` An authentication token obtained from the login.  

- Output Parameters

> **success**:  `Boolean` Returns *true* if the requested operation is valid, otherwise *false*.  
> **msg**:  `String` Additional information or error messages. Usually provided when the requested operation is invalid.  
> **data**: [  
> &nbsp;&nbsp;{  
> &nbsp;&nbsp; **title**: `String` Title of the news.  
> &nbsp;&nbsp; **body**: `String` Detail of the news.  
> &nbsp;&nbsp;}, ...  
> ]

- Example Request

~~~~js
{
  "auth_token": "PbXQ2YTcmyzAXxpA7CF0eOW5Cd6eu/0RS2GZiXEbyLpBZpJh1NY5ynIlb8Pvb/gAD5Ies/gPXeFbZQmCA4p2Pw==",
}
~~~~

 - Example Response

~~~~js
{
  "success": true,
  "msg": null,
  "data": [
    {
      "title": "Welcome to Taxi-Beam!",
      "body": "We would like to give you a warm welcome to our latest innovation. Please enjoy the app."
    },
    {
      ...
    }
  ]
}
~~~~
---
<a name="Searching_for_taxis"></a>
### Searching for taxis
- Retriving a list of taxis with the `ON` status near the current location of the user.  The API returns cars within *SEARCH_RADIUS* meters from the **position**, or the maximum of *MAX_SEARCHRESULT*. The user's favourite car types are displayed first.
- URL `/service/passenger/taxi/nearby`
- Method `POST`
- Input Parameters

> **auth_token**: `String` An authentication token obtained from the login.  
> **position**: `**POSITION_CLASS**` The position which will be used as the central of the search.  
> **zoom_level**: `Integer` The current zoom level of the user interface to display.  

- Output Parameters

> **success**:  `Boolean` Returns *true* if the requested operation is valid, otherwise *false*.  
> **msg**:  `String` Additional information or error messages. Usually provided when the requested operation is invalid.  
> **data**: `Array(**CAR_CLASS**)` Nearby taxi information according to passenger's preferences.

- Example Request

~~~~js
{
  "auth_token": "PbXQ2YTcmyzAXxpA7CF0eOW5Cd6eu/0RS2GZiXEbyLpBZpJh1NY5ynIlb8Pvb/gAD5Ies/gPXeFbZQmCA4p2Pw==",
  "position": [100.57188098030252, 13.75579717605852],
  "zoom_level": 16
}
~~~~

- Example Response

~~~~js
{
  "success": true,
  "msg": null,
  "data": [
    {
	   "car_id": "3351725dfbca57c03301cc",
	   "driver_firstname": "สมรักษ์",
	   "driver_lastname": "คำสิงห์",
	   "driver_mobile_phone": "0853345121",
	   "car_status", "ON"
	   "car_license_plate": "ดช 3324",
	   "car_type": "car",
	   "car_color": 1,
	   "willing_outbound": true,
	   "willing_carryluggage": false,
	   "image_driver": "http://www.taxi-beam.com/upload/drivers/557aa2b078aed5080f702c19.jpg",
	   "image_car": "http://www.taxi-beam.com/upload/cars/557aa2b078aed5080f702c19.jpg",
	   "image_license_plate": "http://www.taxi-beam.com/plates/557aa2b078aed5080f702c19.jpg",
	   "current_position": [100.569663, 13.7528156],
	   "current_direction": [15, 12],
	   "garage_id": "d12702401d7973bf27a1f3"
    },
    {
    	...
    }
  ]
}
~~~~

---
<a name="Calling_a_taxi"></a>
### Calling a taxi
- URL `/service/passenger/call/request`
- Method `POST`
- Input Parameters

> **auth_token**: `String` An authentication token obtained from the login.  
> **from_position**: `**POSITION_CLASS**` The beginning coordinate of the journey.  
> **from_text**: `String` The text description of the beginning position.  
> **to_position**: `**POSITION_CLASS**` The destination coordinate of the journey.  
> **to_text**: `String` The text description of the destination position.  
> **tips**: `Integer` An amount of money to be given to a driver as a favour.  
> **comment**: `String` Additional information to be sent along with the call.  
> **car_type**: `String` Desired car type.  

- Output Parameters

> **success**:  `Boolean` Returns *true* if the requested operation is valid, otherwise *false*.  
> **msg**:  `String` Additional information or error messages. Usually provided when the requested operation is invalid.  
> **data**: {  
> &nbsp;&nbsp; **call_id**: `String` An identification number of the call.  
> }

- Example Request

~~~~js
{
  "auth_token": "PbXQ2YTcmyzAXxpA7CF0eOW5Cd6eu/0RS2GZiXEbyLpBZpJh1NY5ynIlb8Pvb/gAD5Ies/gPXeFbZQmCA4p2Pw==",
  "from_position": [100.5648994, 13.7564630],
  "from_text": "ฟอร์จูน รัชดา",
  "to_position": [100.5394935, 13.7440408],
  "to_text": "โรงพยาบาลตำรวจ",
  "tips": 40,
  "comment": "รออยู่ที่หน้าทางลงรถไฟฟ้าใต้ดิน",
  "car_type": "minivan"
}
~~~~

- Example Response

~~~~js
{
  "success": true,
  "msg": null,
  "data": {
    "call_id": "3914a56a30f9412ffd901c92a8"
  }
}
~~~~

---
<a name="Refreshing_status"></a>
### Refreshing status
- URL `/service/passenger/call/status`
- Method `POST`
- Input Parameters

> **auth_token**: `String` An authentication token obtained from the login.  

- Output Parameters

> **success**:  `Boolean` Returns *true* if the requested operation is valid, otherwise *false*.  
> **msg**:  `String` Additional information or error messages. Usually provided when the requested operation is invalid.  
> **data**: {  
> &nbsp;&nbsp; **passenger_status**: `String` Current status of the passenger.  
> &nbsp;&nbsp; **car_detail**: `**CAR_CLASS**` Detail on the taxi that the passenger is involved. This field is *null* when the passenger's status is either OFF or CALL.  
> }  

- Example Request

~~~~js
{
  "auth_token": "PbXQ2YTcmyzAXxpA7CF0eOW5Cd6eu/0RS2GZiXEbyLpBZpJh1NY5ynIlb8Pvb/gAD5Ies/gPXeFbZQmCA4p2Pw==",
}
~~~~

 - Example Response

~~~~js
{
  "success": true,
  "msg": null,
  "data": {
    "passenger_status": "WAIT",
    "car_detail": {
      "car_id": "3351725dfbca57c03301cc",
      "driver_firstname": "สมรักษ์",
      "driver_lastname": "คำสิงห์",
      "driver_mobile_phone": "0853345121",
      "car_status", "CHALLENGE"
      "car_license_plate": "ดช 3324",
      "car_type": "car",
      "car_color": 1,
      "willing_outbound": true,
      "willing_carryluggage": false,
      "image_driver": "http://www.taxi-beam.com/upload/drivers/557aa2b078aed5080f702c19.jpg",
      "image_car": "http://www.taxi-beam.com/upload/cars/557aa2b078aed5080f702c19.jpg",
      "image_license_plate": "http://www.taxi-beam.com/plates/557aa2b078aed5080f702c19.jpg",
      "current_position": {
        "position": [100.569663, 13.7528156]
      },
      "current_direction": {
        "direction": [15, 12]
      },
      "garage_id": "d12702401d7973bf27a1f3"
    }
  }
}
~~~~

---
<a name="Cancelling_a_call"></a>
### Cancelling a call
- Cancels a call for passengers in *CALL* status.
- URL `/service/passenger/call/cancel`
- Method `POST`
- Input Parameters

> **auth_token**: `String` An authentication token obtained from the login.  
> **call_id**: `String` The call ID that the passenger wants to cancel.

- Output Parameters

> **success**:  `Boolean` Returns *true* if the requested operation is valid, otherwise *false*.  
> **msg**:  `String` Additional information or error messages. Usually provided when the requested operation is invalid.  

- Example Request

~~~~js
{
  "auth_token": "PbXQ2YTcmyzAXxpA7CF0eOW5Cd6eu/0RS2GZiXEbyLpBZpJh1NY5ynIlb8Pvb/gAD5Ies/gPXeFbZQmCA4p2Pw==",
  "call_id": "3914a56a30f9412ffd901c92a8"
}
~~~~

 - Example Response

~~~~js
{
  "success": true,
  "msg": null
}
~~~~

---
<a name="Declining_a_challenge"></a>
### Declining a challenge
- Decline a challenge from taxi. This action will update passengers' status from *WAIT* back to *CALL*.
- URL `/service/passenger/call/decline`
- Method `POST`
- Input Parameters

> **auth_token**: `String` An authentication token obtained from the login.  
> **call_id**: `String` The call ID that the passenger wants to decline.

- Output Parameters

> **success**:  `Boolean` Returns *true* if the requested operation is valid, otherwise *false*.  
> **msg**:  `String` Additional information or error messages. Usually provided when the requested operation is invalid.  

- Example Request

~~~~js
{
  "auth_token": "PbXQ2YTcmyzAXxpA7CF0eOW5Cd6eu/0RS2GZiXEbyLpBZpJh1NY5ynIlb8Pvb/gAD5Ies/gPXeFbZQmCA4p2Pw==",
  "call_id": "3914a56a30f9412ffd901c92a8"
}
~~~~

 - Example Response

~~~~js
{
  "success": true,
  "msg": null
}
~~~~

---
<a name="Accepting_a_challenge"></a>
### Accepting a challenge
- Decline a challenge from taxi. This action will update passengers' status from *WAIT* to *CONFIRM*.
- URL `/service/passenger/call/accept`
- Method `POST`
- Input Parameters

> **auth_token**: `String` An authentication token obtained from the login.  
> **call_id**: `String` The call ID that the passenger wants to decline.

- Output Parameters

> **success**:  `Boolean` Returns *true* if the requested operation is valid, otherwise *false*.  
> **msg**:  `String` Additional information or error messages. Usually provided when the requested operation is invalid.  

- Example Request

~~~~js
{
  "auth_token": "PbXQ2YTcmyzAXxpA7CF0eOW5Cd6eu/0RS2GZiXEbyLpBZpJh1NY5ynIlb8Pvb/gAD5Ies/gPXeFbZQmCA4p2Pw==",
  "call_id": "3914a56a30f9412ffd901c92a8"
}
~~~~

 - Example Response

~~~~js
{
  "success": true,
  "msg": null
}
~~~~

---
<a name="Starting_a_trip"></a>
### Starting a trip
- When a driver arrives, the passenger press the start button. The status of the passenger changes from *CONFIRM* to *JOURNEY*.
- URL `/service/passenger/call/start`
- Method `POST`
- Input Parameters

> **auth_token**: `String` An authentication token obtained from the login.  
> **call_id**: `String` The call ID that the passenger wants to decline.

- Output Parameters

> **success**:  `Boolean` Returns *true* if the requested operation is valid, otherwise *false*.  
> **msg**:  `String` Additional information or error messages. Usually provided when the requested operation is invalid.  

- Example Request

~~~~js
{
  "auth_token": "PbXQ2YTcmyzAXxpA7CF0eOW5Cd6eu/0RS2GZiXEbyLpBZpJh1NY5ynIlb8Pvb/gAD5Ies/gPXeFbZQmCA4p2Pw==",
  "call_id": "3914a56a30f9412ffd901c92a8"
}
~~~~

 - Example Response

~~~~js
{
  "success": true,
  "msg": null
}
~~~~

---
<a name="Ending_a_trip"></a>
### Ending a trip
- After completing a trip, the passenger needs to press the end trip button. The status of the passenger changes from *JOURNEY* to *OFF*.
- URL `/service/passenger/call/end`
- Method `POST`
- Input Parameters

> **auth_token**: `String` An authentication token obtained from the login.  
> **call_id**: `String` The call ID that the passenger wants to decline.

- Output Parameters

> **success**:  `Boolean` Returns *true* if the requested operation is valid, otherwise *false*.  
> **msg**:  `String` Additional information or error messages. Usually provided when the requested operation is invalid.  

- Example Request

~~~~js
{
  "auth_token": "PbXQ2YTcmyzAXxpA7CF0eOW5Cd6eu/0RS2GZiXEbyLpBZpJh1NY5ynIlb8Pvb/gAD5Ies/gPXeFbZQmCA4p2Pw==",
  "call_id": "3914a56a30f9412ffd901c92a8"
}
~~~~

 - Example Response

~~~~js
{
  "success": true,
  "msg": null
}
~~~~

---
<a name="Retriving_favorite_taxis"></a>
### Retriving favorite taxis
- Retriving a list of favorite taxis.
- URL `/service/passenger/taxi/favorite/list`
- Method `POST`
- Input Parameters

> **auth_token**: `String` An authentication token obtained from the login.

- Output Parameters

> **success**:  `Boolean` Returns *true* if the requested operation is valid, otherwise *false*.  
> **msg**:  `String` Additional information or error messages. Usually provided when the requested operation is invalid.  
> **data**: `Array(**CAR_CLASS**)` Taxi information according to passenger’s preferences. 

- Example Request

~~~~js
{
  "auth_token": "PbXQ2YTcmyzAXxpA7CF0eOW5Cd6eu/0RS2GZiXEbyLpBZpJh1NY5ynIlb8Pvb/gAD5Ies/gPXeFbZQmCA4p2Pw=="
}
~~~~

 - Example Response

~~~~js
{
  "success": true,
  "msg": null,
  "data": [
    {
	   "car_id": "3351725dfbca57c03301cc",
	   "driver_firstname": "สมรักษ์",
	   "driver_lastname": "คำสิงห์",
	   "driver_mobile_phone": "0853345121",
	   "car_status", "ON"
	   "car_license_plate": "ดช 3324",
	   "car_type": "car",
	   "car_color": 1,
	   "willing_outbound": true,
	   "willing_carryluggage": false,
	   "image_driver": "http://www.taxi-beam.com/upload/drivers/557aa2b078aed5080f702c19.jpg",
	   "image_car": "http://www.taxi-beam.com/upload/cars/557aa2b078aed5080f702c19.jpg",
	   "image_license_plate": "http://www.taxi-beam.com/plates/557aa2b078aed5080f702c19.jpg",
	   "current_position": [100.569663, 13.7528156],
	   "current_direction": [15, 12],
	   "garage_id": "d12702401d7973bf27a1f3"
    },
    {
    	...
    }
  ]
}
~~~~

---
<a name="Setting_a_favorite_taxi"></a>
### Setting a favorite taxi
- Set or unset a taxi from the favorite list.
- URL `/service/passenger/taxi/favorite/set`
- Method `POST`
- Input Parameters

> **auth_token**: `String` An authentication token obtained from the login.  
> **car_id**: `String` The ID of the car.  
> **favorite**: `Boolean` Tells whether the car is favorite.

- Output Parameters

> **success**:  `Boolean` Returns *true* if the requested operation is valid, otherwise *false*.  
> **msg**:  `String` Additional information or error messages. Usually provided when the requested operation is invalid.  

- Example Request

~~~~js
{
  "auth_token": "PbXQ2YTcmyzAXxpA7CF0eOW5Cd6eu/0RS2GZiXEbyLpBZpJh1NY5ynIlb8Pvb/gAD5Ies/gPXeFbZQmCA4p2Pw==",
  "car_id": "557aa2b078aed5080f702c19",
  "favorite": true
}
~~~~

 - Example Response

~~~~js
{
  "success": true,
  "msg": null
}
~~~~

---
<a name="Retriving_favorite_places"></a>
### Retriving favorite places
- Retriving a list of favorite places.
- URL `/service/passenger/places/list`
- Method `POST`
- Input Parameters

> **auth_token**: `String` An authentication token obtained from the login.

- Output Parameters

> **success**:  `Boolean` Returns *true* if the requested operation is valid, otherwise *false*.  
> **msg**:  `String` Additional information or error messages. Usually provided when the requested operation is invalid.  
> **data**: `Array(**PLACE_CLASS**)` A list of places that were marked as favorite.

- Example Request

~~~~js
{
  "auth_token": "PbXQ2YTcmyzAXxpA7CF0eOW5Cd6eu/0RS2GZiXEbyLpBZpJh1NY5ynIlb8Pvb/gAD5Ies/gPXeFbZQmCA4p2Pw=="
}
~~~~

 - Example Response

~~~~js
{
  "success": true,
  "msg": null,
  "data": [
    {
      "place_id": "13ba9a16e6f2495fa6fc1c044b4e8acd",
      "name": "บริษัท อีคาร์ทสตูดิโอ จำกัด",
      "position": {
        "position": [100.57171, 13.75602]
      }
    },
    {
      ...
    }
  ]
}
~~~~

---
<a name="Setting_a_favorite_place"></a>
### Setting a favorite place
- Set / unset a place to a user's favorite list.
- URL `/service/passenger/places/set`
- Method `POST`
- Input Parameters

> **auth_token**: `String` An authentication token obtained from the login.  
> **favorite**: `Boolean` Indicates whether the following place should set or unset as favorite.  
> **place**: `**PLACE_CLASS**` The place to be processed. (In case of unset, *place_id* is the only parameter to be processed. Otherwise, *place_id* should be null.)  

- Output Parameters

> **success**:  `Boolean` Returns *true* if the requested operation is valid, otherwise *false*.  
> **msg**:  `String` Additional information or error messages. Usually provided when the requested operation is invalid.  

- Example Request (Set)

~~~~js
{
  "auth_token": "PbXQ2YTcmyzAXxpA7CF0eOW5Cd6eu/0RS2GZiXEbyLpBZpJh1NY5ynIlb8Pvb/gAD5Ies/gPXeFbZQmCA4p2Pw==",
  "favorite": true,
  "place": {
    "place_id": "",
    "name": "บริษัท อีคาร์ทสตูดิโอ จำกัด",
    "position": {
      "position": [100.57171, 13.75602]
    }
  }
}
~~~~

- Example Request (Unset)

~~~~js
{
  "auth_token": "PbXQ2YTcmyzAXxpA7CF0eOW5Cd6eu/0RS2GZiXEbyLpBZpJh1NY5ynIlb8Pvb/gAD5Ies/gPXeFbZQmCA4p2Pw==",
  "favorite": false,
  "place": {
    "place_id": "13ba9a16e6f2495fa6fc1c044b4e8acd",
    "name": null,
    "position": null
  }
}
~~~~

 - Example Response

~~~~js
{
  "success": true,
  "msg": null
}
~~~~
